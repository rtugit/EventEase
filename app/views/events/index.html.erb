<!-- Shows header and username -->
<div class="home-page">
  <header class="home-header">
    <div class="header-top">
      <div class="welcome-text">
        <p class="greeting">Welcome Back</p>
        <h1 class="username">
          <%= current_user&.first_name.presence ||
              current_user&.email&.split('@')&.first&.capitalize ||
              "Guest" %>
        </h1>
      </div>

      <div class="header-actions">
        <button class="notification-btn" aria-label="Notifications">
          <span class="badge"></span>
        </button>

        <div class="profile-wrapper">
          <% if current_user %>
            <%= link_to edit_user_registration_path, class: "profile-btn" do %>
              <span class="initials">
                <%= (current_user.first_name.presence || current_user.email&.first).to_s.first.upcase %>
              </span>
            <% end %>
          <% else %>
            <%= link_to new_user_session_path, class: "profile-btn" do %>
              <span class="initials">?</span>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>

    <div class="header-subline">
      <h2 class="page-title">Demo</h2>
    </div>
  </header>

  <!-- Renders search input form -->
  <section class="search-section">
    <div class="search-card">
      <%= form_with url: events_path, method: :get, class: "search-form", local: true do |f| %>
        <div class="search-field">
          <label for="search_title">Title</label>
          <%= text_field_tag :title, params[:title], placeholder: "Search events...", id: "search_title" %>
        </div>

        <div class="search-field">
          <label for="search_location">Location</label>
          <%= text_field_tag :location, params[:location], placeholder: "City or venue", id: "search_location" %>
        </div>

        <div class="search-field">
          <label for="search_date">Date</label>
          <%= date_field_tag :date, params[:date], id: "search_date" %>
        </div>

        <div class="search-action">
          <button type="submit" class="search-btn">Search</button>
        </div>
      <% end %>
    </div>
  </section>

  <!-- Displays event category chips -->
  <section class="categories-section">
    <div class="categories-scroll">
      <%= link_to events_path, class: "category-chip #{'active' unless params[:category]}" do %>
        <span>All</span>
      <% end %>

      <%= link_to events_path(category: "music"), class: "category-chip #{'active' if params[:category] == 'music'}" do %>
        <span>Music</span>
      <% end %>

      <%= link_to events_path(category: "art"), class: "category-chip #{'active' if params[:category] == 'art'}" do %>
        <span>Art</span>
      <% end %>

      <%= link_to events_path(category: "sports"), class: "category-chip #{'active' if params[:category] == 'sports'}" do %>
        <span>Sports</span>
      <% end %>

      <%= link_to events_path(category: "food"), class: "category-chip #{'active' if params[:category] == 'food'}" do %>
        <span>Food</span>
      <% end %>
    </div>
  </section>

  <!-- Shows popular events list -->
  <section class="events-section">
    <div class="section-header">
      <h3 class="section-title">Popular Event</h3>
      <% if @popular_events.present? %>
        <%= link_to "See all", events_path, class: "see-all-link" %>
      <% end %>
    </div>

    <% if @popular_events.present? %>
      <div class="events-grid">
        <% @popular_events.each do |event| %>
          <%= render "event_card", event: event %>
        <% end %>
      </div>
    <% else %>
      <p>You don’t have any events yet.</p>
    <% end %>
  </section>

  <!-- Displays new events section (matches Popular section layout) -->
  <section class="events-section">
    <div class="section-header">
      <h3 class="section-title">New Event</h3>
      <%= link_to "Create event", new_event_path, class: "primary-link" %>
    </div>

    <% if @events.present? %>
      <div class="events-grid">
        <% @events.each do |event| %>
          <%= render "event_card", event: event %>
        <% end %>
      </div>
    <% else %>
      <p>You don’t have any events yet.</p>
    <% end %>
  </section>

  <!-- Renders minimal event list -->
  <section class="events-list-section">
    <ul class="events-list">
      <% @events.each do |event| %>
        <li><%= link_to event.title, event_path(event) %></li>
      <% end %>
    </ul>
  </section>

  <!-- Displays bottom navigation bar -->
  <nav class="bottom-nav">
    <%= link_to events_path, class: "nav-item" do %>
      <span>Home</span>
    <% end %>

    <%= link_to events_path, class: "nav-item" do %>
      <span>Explore</span>
    <% end %>

    <%= link_to new_event_path, class: "nav-item nav-item-add" do %>
      <span>Add</span>
    <% end %>

    <%= link_to events_path, class: "nav-item" do %>
      <span>Events</span>
    <% end %>

    <% if current_user %>
      <%= link_to edit_user_registration_path, class: "nav-item" do %>
        <span>Profile</span>
      <% end %>
    <% else %>
      <%= link_to new_user_session_path, class: "nav-item" do %>
        <span>Login</span>
      <% end %>
    <% end %>
  </nav>
</div>
