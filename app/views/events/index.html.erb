<!-- Welcome Bar -->
<div class="container1">
  <div class="welcome-section">
    <p>Welcome Back</p>
    <h2><%= current_user.first_name || "Guest" %></h2>
  </div>
</div>

<!-- Search Bar -->
<div class="search-box">
  <%= form_with url: events_path, method: :get, class: "d-flex gap-2" do %>
  <div class="form-group">
    <%= label_tag :query, "Title" %>
    <%= text_field_tag :query,
        params[:query],
        class: "form-control",
        placeholder: "Search events..."
      %>
  </div>
  <div class="form-group">
    <%= label_tag :location, "Location" %>
    <%= text_field_tag :location,
        params[:location],
        class: "form-control"
      %>
  </div>
  <div class="form-group">
    <%= label_tag :date, "Date" %>
    <%= date_field_tag :date,
        params[:date],
        class: "form-control"
      %>
  </div>


  <%= submit_tag "Search", name: "", class: "btn btn-primary" %>
  <% end %>
</div>

<!-- Poppular Events -->
<h3 class="section-title">Popular Event</h3>

  <div class="popular-events-row">
    <% @popular_events.each do |event| %>
      <div class="event-card">

      <%= cl_image_tag("THE_IMAGE_ID_FROM_LIBRARY",
        width: 400, height: 300, crop: :fill) %>

        <%= cl_image_tag("IMAGE_WITH_FACE_ID",
      width: 150, height: 150, crop: :thumb, gravity: :face) %>

        <div class="event-info">
          <div class="event-date">
            <%= event.starts_at.strftime("%d") %><br>
            <span><%= event.starts_at.strftime("%b") %></span>
          </div>

          <h4><%= event.title %></h4>
          <p><%= event.location %></p>
        </div>
      </div>
    <% end %>
  </div>

<!-- New Events -->
<div class="d-flex justify-content-between mt-4 mb-2">
    <h3 class="section-title">New Event</h3>
    <%= link_to "See All", events_path %>
  </div>

  <% @new_events.each do |event| %>
    <div class="new-event-item">

      <%= cl_image_tag("THE_IMAGE_ID_FROM_LIBRARY",
        width: 400, height: 300, crop: :fill) %>

        <%= cl_image_tag("IMAGE_WITH_FACE_ID",
      width: 150, height: 150, crop: :thumb, gravity: :face) %>

      <div>
        <p class="event-date-small"><%= event.starts_at.strftime("%d %b %Y") %></p>
        <h4><%= event.title %></h4>
        <p><%= event.location %></p>
      </div>
    </div>
  <% end %>

<% if @events.any? %>
  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Date</th>
        <th>Location</th>
        <th>Registrations</th>
      </tr>
    </thead>

    <tbody>
      <% @events.each do |event| %>
        <tr>
          <td><%= event.title %></td>
          <td><%= event.starts_at.strftime("%d.%m.%Y %H:%M") %></td>
          <td><%= event.location %></td>
          <td>
            <%= event.registrations.size %>
            <% if event.capacity.present? %>
              / <%= event.capacity %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>You donâ€™t have any events yet.</p>
<% end %>

<ul>
  <% @events.each do |event| %>
    <li><%= link_to event.title, event_path(event) %></li>
  <% end %>
</ul>
