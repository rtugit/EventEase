<div class="home-page">
  <!-- Renders search input form with autocomplete -->
  <section class="search-section">
    <div class="search-card">
      <%= form_with url: events_path, method: :get, class: "search-form", local: true do |f| %>
        <div class="search-field">
          <label for="search_title">Title</label>
          <div class="search-input-wrapper">
            <%= text_field_tag :title, params[:title],
                placeholder: "Search events...",
                id: "search_title",
                autocomplete: "off",
                data: { search_type: "title" } %>
            <div class="search-dropdown" id="title-dropdown"></div>
          </div>
        </div>

        <div class="search-field">
          <label for="search_location">Location</label>
          <div class="search-input-wrapper">
            <%= text_field_tag :location, params[:location],
                placeholder: "City or venue",
                id: "search_location",
                autocomplete: "off",
                data: { search_type: "location" } %>
            <div class="search-dropdown" id="location-dropdown"></div>
          </div>
        </div>

        <div class="search-field">
          <label for="search_date">Date</label>
          <%= date_field_tag :date, params[:date], id: "search_date" %>
        </div>

        <div class="search-action">
          <button type="submit" class="search-btn">Search</button>
        </div>
      <% end %>
    </div>
  </section>

  <!-- Displays event category chips -->
  <section class="categories-section">
    <div class="categories-scroll">
      <%= link_to events_path, class: "category-chip #{'active' unless params[:category] || params[:filter] == 'my_events'}" do %>
        <span>All</span>
      <% end %>

      <%= link_to events_path(filter: 'my_events'), class: "category-chip #{'active' if params[:filter] == 'my_events'}" do %>
        <span>My Events</span>
      <% end %>

      <% Event::CATEGORIES.each do |category| %>
        <%= link_to events_path(category: category), class: "category-chip #{'active' if params[:category] == category}" do %>
          <span><%= category %></span>
        <% end %>
      <% end %>
    </div>
  </section>

  <% if params[:filter] == 'my_events' %>
    <!-- Shows My Events -->
    <section class="events-section">
      <div class="section-header">
        <h3 class="section-title">My Events</h3>
      </div>

      <% if @events.present? %>
        <div class="events-grid">
          <% @events.each do |event| %>
            <%= render "event_card", event: event %>
          <% end %>
        </div>
      <% else %>
        <p class="no-events-message">You haven't created or registered for any events yet.</p>
      <% end %>
    </section>
  <% else %>
    <!-- Shows popular events list -->
    <section class="events-section">
      <div class="section-header">
        <h3 class="section-title">Popular Event</h3>
        <% if @popular_events.present? %>
          <%= link_to "See all", events_path, class: "see-all-link" %>
        <% end %>
      </div>

      <% if @popular_events.present? %>
        <div class="events-grid">
          <% @popular_events.each do |event| %>
            <%= render "event_card", event: event %>
          <% end %>
        </div>
      <% else %>
        <p>You don't have any events yet.</p>
      <% end %>
    </section>
  <% end %>

  <!-- Displays bottom navigation bar -->
  <nav class="bottom-nav">
    <%= link_to events_path, class: "nav-item" do %>
      <span>Home</span>
    <% end %>

    <%= link_to events_path, class: "nav-item" do %>
      <span>Explore</span>
    <% end %>

    <%= link_to new_event_path, class: "nav-item nav-item-add" do %>
      <i class="fa-solid fa-plus"></i>
    <% end %>

    <%= link_to events_path, class: "nav-item" do %>
      <span>Events</span>
    <% end %>

    <% if current_user %>
      <%= link_to edit_user_registration_path, class: "nav-item" do %>
        <span>Profile</span>
      <% end %>
    <% else %>
      <%= link_to new_user_session_path, class: "nav-item" do %>
        <span>Login</span>
      <% end %>
    <% end %>
  </nav>
</div>
