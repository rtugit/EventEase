<%= link_to event_path(event), class: "event-card" do %>
  <div class="event-card-image">
    <% if event.respond_to?(:photo) && event.photo.attached? %>
      <%= image_tag event.photo, alt: event.title %>
    <% elsif event.respond_to?(:image) && event.image.attached? %>
      <%= image_tag event.image, alt: event.title %>
    <% else %>
      <div class="placeholder-image">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
          <line x1="16" y1="2" x2="16" y2="6"/>
          <line x1="8" y1="2" x2="8" y2="6"/>
          <line x1="3" y1="10" x2="21" y2="10"/>
        </svg>
      </div>
    <% end %>
  </div>

  <div class="event-card-body">
    <h3 class="event-title"><%= event.title %></h3>

    <% if event.starts_at.present? %>
      <p class="event-date">
        <%= event.starts_at.strftime("%d.%m.%Y Â· %H:%M") %>
      </p>
    <% end %>

    <% if event.location.present? %>
      <p class="event-location"><%= event.location %></p>
    <% end %>
  </div>

  <div class="avatars">
    <% event.registrations.limit(3).each do |registration| %>
      <% handle = registration.email.to_s.split("@").first %>
      <% initials = handle[0, 2].to_s.upcase %>
      <div class="avatar"><%= initials.presence || "?" %></div>
    <% end %>

    <% if event.registrations.count > 3 %>
      <div class="avatar avatar-more">
        +<%= event.registrations.count - 3 %>
      </div>
    <% end %>
  </div>
<% end %>
